import{d as $,u as U,r as i,a as E,b as G,c as d,o as L,_ as T,e as t,f as l,g as s,t as o,w as c,v as w,h as y,F as g,i as p,j as V}from"./index-8_AR_92z.js";const B=$({setup(){const e=U(),r=i([]),u=i([]),C=E(),b=G(),m=i([]),a=i([]),S=i(""),v=i(""),h=d(()=>e.allCategorias),I=d(()=>e.allIngredientes),M=d(()=>h.value.filter(n=>n.nombreCategoria.toLowerCase().includes(S.value.toLowerCase()))),A=d(()=>I.value.filter(n=>n.nombreIngrediente.toLowerCase().includes(v.value.toLowerCase()))),k=async()=>{try{const n={idMenuSemanal:0,descripcion:"Menú Semanal generado",fechaInicio:new Date().toISOString().split("T")[0],tipoComida:!0,categorias:r.value,alergenos:u.value,idUsuario:1,recetas:[]};await C.crearMenuSemanal(n),b.push("/MenuSemanal")}catch(n){console.error("Error al generar el menú semanal:",n)}},q=async()=>{try{await e.guardarCategoriasSeleccionadas(r.value),alert("Preferencias guardadas exitosamente"),await f()}catch(n){console.error("Error al guardar preferencias:",n)}},F=async()=>{try{await e.guardarAlergenosSeleccionados(u.value),alert("Preferencias guardadas exitosamente"),await f()}catch(n){console.error("Error al guardar preferencias:",n)}},f=async()=>{try{await e.obtenerCategorias(),await e.obtenerAlergenos(),m.value=e.usuariosCategoria,a.value=e.ingredientes.filter(n=>e.ingredientes.some(P=>P.idIngrediente==n.idIngrediente))}catch(n){console.error("Error al obtener preferencias guardadas:",n)}};return L(async()=>{await e.fetchCategorias(),await e.getAllIngredientes(),await f()}),{categoriasSeleccionadas:r,alergenosSeleccionados:u,categoriasGuardadas:m,alergenosGuardados:a,busquedaCategorias:S,busquedaAlergenos:v,categoriasFiltradas:M,alergenosFiltrados:A,guardarCategorias:q,guardarAlergenos:F,generarMenuSemanal:k}}}),D={class:"preferencias-container"},j={class:"preferencias-categorias"},N=["placeholder"],O=["value"],R={class:"preferencias-alergenos"},z=["placeholder"],H=["value"],J={class:"preferencias-guardadas"};function K(e,r,u,C,b,m){return t(),l("div",D,[s("section",j,[s("h2",null,o(e.$t("preferencias.categoriasTitulo")),1),c(s("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=a=>e.busquedaCategorias=a),placeholder:e.$t("preferencias.buscarCategorias"),class:"buscador-categorias"},null,8,N),[[w,e.busquedaCategorias]]),c(s("select",{"onUpdate:modelValue":r[1]||(r[1]=a=>e.categoriasSeleccionadas=a),multiple:"",class:"categoria-select"},[(t(!0),l(g,null,p(e.categoriasFiltradas,a=>(t(),l("option",{key:a.idCategoria,value:a.idCategoria},o(a.nombreCategoria),9,O))),128))],512),[[y,e.categoriasSeleccionadas]]),s("button",{onClick:r[2]||(r[2]=(...a)=>e.guardarCategorias&&e.guardarCategorias(...a)),class:"btn-guardar"},o(e.$t("preferencias.guardar")),1)]),s("section",R,[s("h2",null,o(e.$t("preferencias.alergenosTitulo")),1),c(s("input",{type:"text","onUpdate:modelValue":r[3]||(r[3]=a=>e.busquedaAlergenos=a),placeholder:e.$t("preferencias.buscarAlergenos"),class:"buscador-alergenos"},null,8,z),[[w,e.busquedaAlergenos]]),c(s("select",{"onUpdate:modelValue":r[4]||(r[4]=a=>e.alergenosSeleccionados=a),multiple:"",class:"alergenos-select"},[(t(!0),l(g,null,p(e.alergenosFiltrados,a=>(t(),l("option",{key:a.idIngrediente,value:a.idIngrediente},o(a.nombreIngrediente),9,H))),128))],512),[[y,e.alergenosSeleccionados]]),s("button",{onClick:r[5]||(r[5]=(...a)=>e.guardarAlergenos&&e.guardarAlergenos(...a)),class:"btn-guardar"},o(e.$t("preferencias.guardar")),1)]),s("section",J,[s("h2",null,o(e.$t("preferencias.guardadasTitulo")),1),s("div",null,[s("h3",null,o(e.$t("preferencias.categoriasSeleccionadas")),1),s("ul",null,[(t(!0),l(g,null,p(e.categoriasGuardadas,a=>(t(),l("li",{key:a.idCategoria},o(a.nombreCategoria),1))),128))]),s("h3",null,o(e.$t("preferencias.alergenosSeleccionados")),1),s("ul",null,[(t(!0),l(g,null,p(e.alergenosGuardados,a=>(t(),l("li",{key:a.idAlergeno},o(a.nombreIngrediente),1))),128))])])]),s("button",{onClick:r[6]||(r[6]=(...a)=>e.generarMenuSemanal&&e.generarMenuSemanal(...a)),class:"btn-generar-menu"},o(e.$t("preferencias.generarMenu")),1)])}const Q=T(B,[["render",K],["__scopeId","data-v-78ddb90f"]]),X=$({__name:"PreferenciasUsuario",setup(e){return(r,u)=>(t(),V(Q))}});export{X as default};
